# ![nf-core/pcgr](docs/images/nf-pcgr.png)

## Introduction

**nf-pcgr** is a bioinformatics analysis pipeline for the functional annotation and translation of somatic SNVs/InDels and copy number abberations for precision cancer medicine using [Personal Cancer Genome Reporter (PCGR)](https://github.com/sigven/pcgr). **nf-pcgr** offers germline SNVs/INDELS intepretation and annotation using [Cancer Predisposition Sequencing Reporter (CPSR)](https://github.com/sigven/cpsr/).

The workflow has been designed to accept outputs generated by [nf-core/sarek](https://github.com/nf-core/sarek):

| Tool                   |      Germline      | Somatic tumor-normal | Somatic tumor-only |
| ---------------------- | :----------------: | :------------------: | :----------------: |
| CNVkit                 |                    |  :heavy_check_mark:  | :heavy_check_mark: |
| DeepVariant            | :heavy_check_mark: |                      |                    |
| FreeBayes              | :heavy_check_mark: |  :heavy_check_mark:  | :heavy_check_mark: |
| HaplotypeCaller        | :heavy_check_mark: |                      |                    |
| Mutect2                |                    |  :heavy_check_mark:  | :heavy_check_mark: |
| Strelka somatic indels |                    |  :heavy_check_mark:  |                    |
| Strelka somatic snvs   |                    |  :heavy_check_mark:  |                    |
| Strelka variants       | :heavy_check_mark: |                      | :heavy_check_mark: |

## Pipeline summary

# ![nf-core/pcgr](docs/images/schematic.png)

![PCGR](https://raw.githubusercontent.com/sigven/pcgr/master/pcgrr/pkgdown/assets/img/pcgr_dashboard_views.png)

![CPSR](https://raw.githubusercontent.com/sigven/cpsr/master/pkgdown/assets/img/cpsr_views.png)

## Quick Start

1. Install [`Nextflow`](https://www.nextflow.io/docs/latest/getstarted.html#installation) (`>=22.10.4`)

2. Install [`Docker`](https://docs.docker.com/engine/installation/) or [`Singularity`](https://www.sylabs.io/guides/3.0/user-guide/)

3. Download and unpack the human assembly-specific data bundle:

- [grch37 data bundle](http://insilico.hpc.uio.no/pcgr/pcgr.databundle.grch37.20220203.tgz) - 20220203 (approx 20Gb)

- [grch38 data bundle](http://insilico.hpc.uio.no/pcgr/pcgr.databundle.grch38.20220203.tgz) - 20220203 (approx 21Gb)

```bash
GENOME="grch38" # or "grch37"
BUNDLE_VERSION="20220203"
BUNDLE="pcgr.databundle.${GENOME}.${BUNDLE_VERSION}.tgz"

wget http://insilico.hpc.uio.no/pcgr/${BUNDLE}
gzip -dc ${BUNDLE} | tar xvf -
```

> Pass the directory containing the uncompressed `data/` directory to **nf-pcgr** using the `--database` parameter for both `PCGR` and `CPSR`.

3. Download the pipeline and test it on a minimal dataset with a single command:

```console
nextflow pull BarryDigby/nf-pcgr
nextflow run BarryDigby/nf-pcgr -profile test,<docker/singularity> --database '<path to PCGR database>'
```

## Documentation

The nf-core/pcgr pipeline comes with documentation about the pipeline [usage](https://nf-co.re/pcgr/usage), [parameters](https://nf-co.re/pcgr/parameters) and [output](https://nf-co.re/pcgr/output).

## Credits

nf-core/pcgr was originally written by Barry Digby.

We thank the following people for their extensive assistance in the development of this pipeline:

- Sam Minot ([@sminot](https://github.com/sminot))

- Nathan Thorpe ([@nathanthorpe](https://github.com/nathanthorpe))

## Contributions and Support

If you would like to contribute to this pipeline, please see the [contributing guidelines](.github/CONTRIBUTING.md).

For further information or help, don't hesitate to get in touch on the [Slack `#pcgr` channel](https://nfcore.slack.com/channels/pcgr) (you can join with [this invite](https://nf-co.re/join/slack)).

## Citations

> **Cancer Predisposition Sequencing Reporter (CPSR): A flexible variant report engine for high-throughput germline screening in cancer**
> Nakken S, Saveliev V, Hofmann O, Møller P, Myklebost O, Hovig E.
> _Int J Cancer._ 2021 Dec 1;149(11):1955-1960. doi:[10.1002/ijc.33749](https://doi.org/10.1002/ijc.33749)

> **Personal Cancer Genome Reporter: variant interpretation report for precision oncology**
> Nakken S, Fournous G, Vodák D, Aasheim LB, Myklebost O, Hovig E.
> _Bioinformatics._ 2018 May 15;34(10):1778-1780. doi: [10.1093/bioinformatics/btx817](https://doi.org/10.1093%2Fbioinformatics%2Fbtx817)

> **Sarek: A portable workflow for whole-genome sequencing analysis of germline and somatic variants**
> Garcia M, Juhos S, Larsson M, Olason PI, Martin M, Eisfeldt J, DiLorenzo S, Sandgren J, Díaz De Ståhl T, Ewels P, Wirta V, Nistér M, Käller M, Nystedt B.
> _F1000Res._ 2020 Jan 29;9:63. doi: [10.12688/f1000research.16665.2](https://doi.org/10.12688%2Ff1000research.16665.2)

> **The nf-core framework for community-curated bioinformatics pipelines.**
>
> Philip Ewels, Alexander Peltzer, Sven Fillinger, Harshil Patel, Johannes Alneberg, Andreas Wilm, Maxime Ulysse Garcia, Paolo Di Tommaso & Sven Nahnsen.
>
> _Nat Biotechnol._ 2020 Feb 13. doi: [10.1038/s41587-020-0439-x](https://dx.doi.org/10.1038/s41587-020-0439-x).
